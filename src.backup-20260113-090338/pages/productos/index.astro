---
import PublicLayout from '@layouts/PublicLayout.astro';
import ProductCard from '@components/product/ProductCard.astro';
import { supabase } from '@lib/supabase';

const { data: products } = await supabase
  .from('products')
  .select('*')
  .order('created_at', { ascending: false });

const { data: categories } = await supabase
  .from('categories')
  .select('*')
  .order('name');
---

<PublicLayout title="Todos los Productos - FashionMarket">
  <div class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <div class="mb-12">
      <h1 class="font-serif text-4xl md:text-5xl font-bold text-brand-navy mb-4">
        Todos los Productos
      </h1>
      <p class="text-lg text-brand-slate">
        Explora nuestra colecci√≥n completa de moda masculina premium
      </p>
    </div>

    {categories && categories.length > 0 && (
      <div class="mb-8 flex flex-wrap gap-4">
        <a
          href="/productos"
          class="px-6 py-2 border-2 border-brand-navy bg-brand-navy text-white font-medium"
        >
          Todos
        </a>
        {categories.map((category) => (
          <a
            href={`/categoria/${category.slug}`}
            class="px-6 py-2 border-2 border-brand-slate/30 hover:border-brand-navy transition-colors font-medium"
          >
            {category.name}
          </a>
        ))}
      </div>
    )}

    {products && products.length > 0 ? (
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
        {products.map((product) => (
          <ProductCard product={product} />
        ))}
      </div>
    ) : (
      <div class="text-center py-12">
        <p class="text-brand-slate text-lg">No hay productos disponibles en este momento.</p>
      </div>
    )}
  </div>
</PublicLayout>
