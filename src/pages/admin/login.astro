---
export const prerender = false;

import BaseLayout from '@layouts/BaseLayout.astro';

const error = Astro.url.searchParams.get('error');
const message = Astro.url.searchParams.get('message');

// Mapeo de mensajes de error
const errorMessages = {
  missing_credentials: 'Por favor, ingresa email y contraseña.',
  invalid_email: 'El formato del email no es válido.',
  invalid_credentials: 'Credenciales incorrectas. Verifica tu email y contraseña.',
  not_admin: 'Esta cuenta no tiene permisos de administrador.',
  account_disabled: 'Tu cuenta ha sido desactivada. Contacta al administrador.',
  unauthorized: 'Tu sesión ha expirado. Por favor, inicia sesión nuevamente.',
};

const successMessages = {
  logged_out: 'Sesión cerrada correctamente.',
};
---

<BaseLayout title="Admin Login - FashionMarket">
  <div class="min-h-screen bg-brand-navy flex items-center justify-center px-4">
    <div class="max-w-md w-full bg-white rounded-lg shadow-2xl p-8">
      <div class="text-center mb-8">
        <h1 class="font-serif text-3xl font-bold text-brand-navy mb-2">
          FashionMarket Admin
        </h1>
        <p class="text-brand-slate">
          Inicia sesión para acceder al panel de administración
        </p>
      </div>

      {error && (
        <div class="mb-6 p-4 bg-red-50 border border-red-200 rounded text-red-800 text-sm">
          {errorMessages[error as keyof typeof errorMessages] || 'Ha ocurrido un error. Intenta nuevamente.'}
        </div>
      )}

      {message && (
        <div class="mb-6 p-4 bg-green-50 border border-green-200 rounded text-green-800 text-sm">
          {successMessages[message as keyof typeof successMessages] || message}
        </div>
      )}

      <form action="/api/admin/login" method="POST" class="space-y-6">
        <div>
          <label for="email" class="block text-sm font-medium text-brand-charcoal mb-2">
            Email
          </label>
          <input
            type="email"
            id="email"
            name="email"
            required
            class="input-field"
            placeholder="admin@fashionmarket.com"
            autocomplete="email"
          />
        </div>

        <div>
          <label for="password" class="block text-sm font-medium text-brand-charcoal mb-2">
            Contraseña
          </label>
          <input
            type="password"
            id="password"
            name="password"
            required
            class="input-field"
            placeholder="••••••••"
          />
        </div>

        <button type="submit" class="w-full btn-primary">
          Iniciar Sesión
        </button>
      </form>

      <div class="mt-6 text-center">
        <a href="/" class="text-sm text-brand-slate hover:text-brand-navy">
          ← Volver a la tienda
        </a>
      </div>
    </div>
  </div>
</BaseLayout>
